<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>ν¬μΈνΈ μƒμ </title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/css/shop.css">
</head>
<body>
	<!-- μƒλ‹¨ λ„¤λΉ„κ²μ΄μ… λ°” -->
	<div class="navbar">
		<div class="logo">
			<a href="http://localhost:8080/matches/list" class="logo-link"> <img
				src="/logo.png" alt="ν™νμ΄μ§€ λ΅κ³ " class="logo-img"> <span
				class="logo-text"></span>
			</a>
		</div>
		<div class="nav-buttons">
			<button onclick="location.href='/matches/list'">λ©”μΈν™”λ©΄</button>
			<button onclick="location.href='/community'">μ»¤λ®¤λ‹ν‹°</button>
			<button onclick="location.href='/prediction'">μΉλ¶€μμΈ΅</button>
			<button onclick="location.href='/past-matches/list'">κ²°κ³Όν™•μΈ</button>  <!-- μ¶”κ°€λ λ²„νΌ -->
			<button onclick="location.href='/shop'">ν¬μΈνΈ μƒμ </button>
			<button onclick="location.href='/mypage'">λ§μ΄νμ΄μ§€</button>
		</div>
	</div>
	
	<!-- κµ¬λ§¤ λ¨λ‹¬ -->
<div id="purchaseModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <h2>μ•„μ΄ν… κµ¬λ§¤</h2>
        <p>μ„ νƒν• μ•„μ΄ν…: <span id="itemName"></span></p>
        <p>κ°€κ²©: <span id="itemPrice"></span> ν¬μΈνΈ</p>
        <form th:action="@{/purchase}" method="post">
    <input type="hidden" name="itemId" id="itemId">
    <label for="size">μ‚¬μ΄μ¦ μ„ νƒ:</label>
    <select name="size" id="size" required>
        <option value="S">S</option>
        <option value="M">M</option>
        <option value="L">L</option>
        <option value="XL">XL</option>
        <option value="2XL">2XL</option>
        <option value="3XL">3XL</option>
    </select>
    <br><br>
    <button type="submit" class="confirm">κµ¬λ§¤ κ²°μ •</button>
    <button type="button" class="cancel" onclick="closeModal()">μ·¨μ†</button>
</form>

    </div>
</div>

	<!-- ν¬μΈνΈ μƒμ  μ½ν…μΈ  -->
	<div class="content">
		<div class="shop-header">
			<h1>ν¬μΈνΈ μƒμ </h1>
			<p>
    ν¬μΈνΈ: 
    <span th:if="${session.loggedInUser != null}" th:text="${session.loggedInUser?.points ?: 0} + 'μ '"></span>
    <span th:if="${session.loggedInUser == null}">0μ </span>
</p>

<p style="color: red; font-size: 14px; margin-top: 10px;">
            β€»νμ›κ°€μ… μ§„ν–‰ μ‹ μ„¤μ •ν• μ£Όμ†λ΅ λ°°μ†΅λ©λ‹λ‹¤. κµ¬λ§¤ μ „ λ§μ΄νμ΄μ§€μ—μ„ μ£Όμ†λ¥Ό ν™•μΈν•΄μ£Όμ„Έμ”.β€»
        </p>
        <p style="color: red; font-size: 14px; margin-top: 10px;">
            β€»κµ¬λ§¤ μ§„ν–‰ μ‹ μ‚¬μ΄μ¦ ν™•μΈμ„ κΌ­ λ¶€νƒλ“λ¦½λ‹λ‹¤. κµ¬λ§¤ ν›„μ—λ” λ°ν’μ΄ λ¶κ°€λ¥ν•μ¤λ‹ μ‹ μ¤‘ν• μ„ νƒ λ¶€νƒλ“λ¦½λ‹λ‹¤.β€»
        </p>
		</div>
		<p th:if="${message != null}" th:text="${message}"
			style="color: green;"></p>

		<!-- μ λ‹νΌ μΉ΄λ“ ν–‰ -->
<div class="card-container">
    <div class="card" th:each="item : ${items}">
        <img th:src="@{${item.imageUrl}}" alt="μƒν’ μ΄λ―Έμ§€">
        <h3 th:text="${item.name}">μƒν’ μ΄λ¦„</h3>
        <p th:text="${item.price} + ' ν¬μΈνΈ'">κ°€κ²©</p>
        <a class="details-link" th:href="${item.link}" target="_blank" th:text="'μμ„Έν λ³΄κΈ°'"></a>
        <form th:action="@{/purchase}" method="post">
            <input type="hidden" name="itemId" th:value="${item.id}" />
            <button type="button" onclick="openModal(1)">κµ¬λ§¤ν•κΈ°</button>
        </form>
    </div>
</div>

<!-- ν›μ¥ μΉ΄λ“ ν–‰ -->
<div class="card-container">
    <div class="card badge-card" th:each="badge : ${badges}">
        <img th:src="@{'/' + ${badge.imageUrl}}" alt="ν›μ¥ μ΄λ―Έμ§€">
        <h3 th:text="${badge.name}">ν›μ¥ μ΄λ¦„</h3>
        <p th:text="${badge.price} + ' ν¬μΈνΈ'">κ°€κ²©</p>
        <p th:text="${badge.description}">ν›μ¥ μ„¤λ…</p>
        <form th:action="@{/purchase/badge}" method="post">
            <input type="hidden" name="badgeId" th:value="${badge.id}" />
            <button type="submit">κµ¬λ§¤ν•κΈ°</button>
        </form>
    </div>
</div>

		
		
		
	</div>
	<!-- Chatbot UI -->
<div id="chatbot-container" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
    <div id="chatbot-window" style="display: none; width: 500px; height: 570px; background: white; border: 1px solid #ccc; box-shadow: 0px 4px 8px rgba(0,0,0,0.2); border-radius: 8px;">
        <!-- μ±—λ΄‡ ν—¤λ” -->
        <div style="background: #333; color: white; padding: 10px; border-top-left-radius: 8px; border-top-right-radius: 8px; font-weight: bold;">
            μ±—λ΄‡
            <button id="chatbot-close" style="float: right; background: none; border: none; color: white; font-size: 16px; cursor: pointer;">Γ—</button>
        </div>
        <!-- λ©”μ‹μ§€ μμ—­ -->
        <div id="chatbot-messages" style="padding: 10px; height: 450px; overflow-y: auto; font-size: 14px; border-bottom: 1px solid #ccc;">
            <!-- λ©”μ‹μ§€κ°€ μ—¬κΈ°μ— μ¶”κ°€λ©λ‹λ‹¤ -->
        </div>
        <!-- μ…λ ¥μ°½ -->
        <div style="padding: 5px; border-top: 1px solid #ccc; display: flex; gap: 5px; align-items: center;">
            <input id="chatbot-input" type="text" placeholder="μ§λ¬Έμ„ μ…λ ¥ν•μ„Έμ”" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;">
            <button id="chatbot-send" style="padding: 8px 12px; background: #333; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">μ „μ†΅</button>
        </div>
    </div>
    <button id="chatbot-toggle" style="width: 70px; height: 70px; background: #333; color: white; border: none; border-radius: 50%; cursor: pointer; font-size: 22px;">π’¬</button>
</div>
<script src="/js/Chatbot.js"></script>
</body>
</html>

<script>
function openModal(itemId) {
    const modal = document.getElementById('purchaseModal');
    modal.style.display = 'flex';

    // μ„λ²„μ—μ„ κ°€μ Έμ¨ μ•„μ΄ν… μ •λ³΄ (ν…ν”λ¦Ώμ—μ„ μ „λ‹¬λ°›λ” λ°μ΄ν„° ν™μ© κ°€λ¥)
    const items = [
        { id: 1, name: "λ§¨μ‹ν‹° μ λ‹νΌ", price: 200000 },
        { id: 2, name: "λ¦¬λ²„ν’€ μ λ‹νΌ", price: 200000 },
        { id: 3, name: "μ•„μ¤λ‚  μ λ‹νΌ", price: 200000 },
        { id: 4, name: "μ²Όμ‹ μ λ‹νΌ", price: 200000 },
        { id: 5, name: "ν† νΈλ„ μ λ‹νΌ", price: 200000 },
        { id: 6, name: "λ§¨μ  μ λ‹νΌ", price: 200000 }
    ];
    const selectedItem = items.find(item => item.id === itemId);

    if (selectedItem) {
        document.getElementById('itemId').value = selectedItem.id;
        document.getElementById('itemName').innerText = selectedItem.name;
        document.getElementById('itemPrice').innerText = selectedItem.price;
    }
}

function closeModal() {
    const modal = document.getElementById('purchaseModal');
    modal.style.display = 'none';
}
</script>
